# ~/.tmux.conf managed by dotfiles (stow).

# ==========================================
#  Core Settings
# ==========================================
# Consistent terminal setting
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# Prefix: C-space
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Indices and history
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g history-limit 100000

# Input/UX tuning
set -g escape-time 0
set -g repeat-time 300
set -g mouse off
set -g focus-events on

# Use vi keys in copy mode
set -g mode-keys vi
setw -g mode-keys vi

# ==========================================
#  Key Bindings
# ==========================================
# Splits and reload
bind | split-window -h
bind - split-window -v
bind r source-file ~/.tmux.conf \; display-message "tmux reloaded"

# Fast pane navigation (Note: C-j takes over newline)
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# Resize panes with Alt + hjkl
bind -n M-h resize-pane -L 5
bind -n M-j resize-pane -D 5
bind -n M-k resize-pane -U 5
bind -n M-l resize-pane -R 5

# Copy mode (vi) with WSL clipboard
set -g set-clipboard on
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "win32yank.exe -i --crlf"

# ==========================================
#  Visual Styling (High Contrast)
# ==========================================

# 1. 枠線 (Border)
# アクティブ: 蛍光グリーン (#00ff00) で強烈に主張（シアンより目立ちます）
set -g pane-active-border-style "fg=#00ff00,bg=default"

# 非アクティブ: 暗い青グレーで沈ませる
set -g pane-border-style "fg=colour236,bg=default"

# 2. 背景と文字 (Window Style)
# アクティブ:
#   文字は真っ白 (brightwhite)
#   背景は「黒 (#000000)」でクッキリさせる (透過させたい場合は default に戻してください)
setw -g window-active-style 'fg=brightwhite,bg=#000000'

# 非アクティブ:
#   文字を「かなり暗いグレー (colour237)」にして、存在感を消す ★ここがポイント
#   背景を「少し明るめのグレー (colour235)」にして、アクティブな黒との差を出す
setw -g window-style 'fg=colour237,bg=colour235'

# ==========================================
#  Plugins (TPM)
# ==========================================
set -g @plugin "tmux-plugins/tpm"
set -g @plugin "tmux-plugins/tmux-sensible"
set -g @plugin "christoomey/vim-tmux-navigator"
set -g @plugin "tmux-plugins/tmux-resurrect"
set -g @plugin "tmux-plugins/tmux-continuum"
set -g @plugin "tmux-plugins/tmux-yank"
set -g @plugin "tmux-plugins/tmux-prefix-highlight"

# Plugin Settings
set -g @continuum-restore "off"
set -g @resurrect-capture-pane-contents "on"
set -g @yank_action "copy-pipe"

# TPM Init (Must be at the bottom)
run "~/.tmux/plugins/tpm/tpm"

# ==========================================
#  Overrides / Hacks
# ==========================================
# 1. F13の信号(\e[25~ )を "User0" というカスタムキーとして登録
set -s user-keys[0] "\e[25~"

# 2. その User0 が押されたら改行(C-j)する
bind-key -n User0 send-keys C-j
